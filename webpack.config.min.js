const webpack = require('webpack')
const merge = require('webpack-merge');
const basic = require('./webpack.config');
const UglifyJsPlugin = require('uglifyjs-webpack-plugin');
// const webpackConfig = Object.create(require('./webpack.config.js'))
// webpackConfig.mode = 'production'

// webpackConfig.output = Object.create(webpackConfig.output)
// webpackConfig.output.filename = webpackConfig.output.filename.replace(/\.js$/, '.min.js')

// webpackConfig.plugins = webpackConfig.plugins.concat(
//   new webpack.optimize.UglifyJsPlugin({ minimize: true, sourceMap: true })
// )

const webpackConfig = merge(basic, {
  mode: 'production',
  output: {
    filename: basic.output.filename.replace(/\.js$/, '.min.js')
  },
  optimization: {
    minimizer: [
      new UglifyJsPlugin()
    ]
  }
})

module.exports = webpackConfig
